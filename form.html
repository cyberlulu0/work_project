<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Competency Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 1rem;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #0d3050;
            color: white;
            line-height: 1.5;
        }
        .form-container {
            width: 90%;
            max-width: 50rem;
            background: #0194d3;
            padding: 1.25rem;
            border-radius: 0.5rem;
            box-shadow: 0 0.25rem 0.375rem rgba(0, 0, 0, 0.2);
        }
        .hidden {
            display: none;
        }
        label, input, select, button {
            display: block;
            width: 100%;
            margin-bottom: 1rem;
        }
        input, select, button {
            padding: 0.5rem;
            border-radius: 0.5rem;
            border: none;
        }
        button {
            background: #0056b3;
            color: white;
            cursor: pointer;
        }
        button:hover {
            background: #003f80;
        }
    </style>
</head>
<body>

<div class="form-container">
    <form id="user-info-form">
        <h1>User Information</h1>
        <label for="full-name">Full Name:</label>
        <input type="text" id="full-name" name="full-name" required>

        <label for="email">Email Address:</label>
        <input type="email" id="email" name="email" required>

        <label for="role">Role:</label>
        <input type="text" id="role" name="role" required>

        <label for="state">State:</label>
        <select id="state" name="state" required>
            <option value="NSW">NSW</option>
            <option value="VIC">VIC</option>
            <option value="QLD">QLD</option>
            <option value="SA">SA</option>
            <option value="WA">WA</option>
        </select>

        <label for="facility-name">Name of your facility:</label>
        <input type="text" id="facility-name" name="facility-name" required>

        <button type="button" onclick="showQuizPage()">Next</button>
    </form>

    <form id="quiz-form" class="hidden">
        <h1>Competency Test</h1>
        <p>Answer the following questions:</p>

        <!-- Quiz Questions -->
        <label>1. How can you access the Ramsay Referrals portal from your hospital’s intranet?</label>
        <input type="radio" id="q1a" name="q1" value="a"> <label for="q1a">By navigating to SharePoint</label>
        <input type="radio" id="q1b" name="q1" value="b"> <label for="q1b">Through the Ramsay Referrals link on the intranet</label>
        <input type="radio" id="q1c" name="q1" value="c"> <label for="q1c">Both a and b</label>

        <label>2. What button should you click on the homepage to start a new referral?</label>
        <input type="radio" id="q2a" name="q2" value="a"> <label for="q2a">Search</label>
        <input type="radio" id="q2b" name="q2" value="b"> <label for="q2b">New Referral</label>
        <input type="radio" id="q2c" name="q2" value="c"> <label for="q2c">View Referral</label>

        <label>3. Which status filter can you apply on the Referrer page?</label>
        <input type="radio" id="q3a" name="q3" value="a"> <label for="q3a">Pending</label>
        <input type="radio" id="q3b" name="q3" value="b"> <label for="q3b">Draft</label>
        <input type="radio" id="q3c" name="q3" value="c"> <label for="q3c">Both a and b</label>

        <label>4. What information is necessary on the Patient Details page?</label>
        <input type="radio" id="q4a" name="q4" value="a"> <label for="q4a">Patient’s phone number and email</label>
        <input type="radio" id="q4b" name="q4" value="b"> <label for="q4b">Referral ID</label>
        <input type="radio" id="q4c" name="q4" value="c"> <label for="q4c">Doctor's name</label>

        <label>5. What should you do if the referral is urgent?</label>
        <input type="radio" id="q5a" name="q5" value="a"> <label for="q5a">Submit the referral immediately</label>
        <input type="radio" id="q5b" name="q5" value="b"> <label for="q5b">Call to secure the appointment and add a comment</label>
        <input type="radio" id="q5c" name="q5" value="c"> <label for="q5c">Save the referral as a draft</label>

        <label>6. Which types of services can be selected for a referral?</label>
        <input type="radio" id="q6a" name="q6" value="a"> <label for="q6a">Only Psychology services</label>
        <input type="radio" id="q6b" name="q6" value="b"> <label for="q6b">Both Allied Health and Psychology services</label>
        <input type="radio" id="q6c" name="q6" value="c"> <label for="q6c">Only Dietetics services</label>

        <label>7. Who can cancel a referral?</label>
        <input type="radio" id="q7a" name="q7" value="a"> <label for="q7a">Any staff member with access</label>
        <input type="radio" id="q7b" name="q7" value="b"> <label for="q7b">The individual who created the referral or a site-admin</label>
        <input type="radio" id="q7c" name="q7" value="c"> <label for="q7c">Only the site-admin</label>

        <label>8. How can the recipient of a referral update its status?</label>
        <input type="radio" id="q8a" name="q8" value="a"> <label for="q8a">By clicking on “View Referral” and selecting the action pop-up</label>
        <input type="radio" id="q8b" name="q8" value="b"> <label for="q8b">By calling the referrer</label>
        <input type="radio" id="q8c" name="q8" value="c"> <label for="q8c">By going to the Referrer page</label>

        <label>9. What information can you find in the Activity History of a referral?</label>
        <input type="radio" id="q9a" name="q9" value="a"> <label for="q9a">Patient’s family history</label>
        <input type="radio" id="q9b" name="q9" value="b"> <label for="q9b">Timeline of actions and updates related to the referral</label>
        <input type="radio" id="q9c" name="q9" value="c"> <label for="q9c">Contact details of all referring doctors</label>

        <label>10. What is the correct way to print a referral from the referral details page?</label>
        <input type="radio" id="q10a" name="q10" value="a"> <label for="q10a">Right-click and select “Print”</label>
        <input type="radio" id="q10b" name="q10" value="b"> <label for="q10b">Use the “Print Preview” button and follow print options</label>
        <input type="radio" id="q10c" name="q10" value="c"> <label for="q10c">Copy and paste the referral details to Word</label>

        <button type="button" onclick="showResultsPage()">Submit</button>
    </form>

    <div id="results" class="hidden">
        <h1>Results</h1>
        <p id="results-message"></p>
        <button type="button" onclick="submitData()">Finish</button>
    </div>
</div>

<script>
    function showQuizPage() {
        document.getElementById('user-info-form').classList.add('hidden');
        document.getElementById('quiz-form').classList.remove('hidden');
    }

    function showResultsPage() {
        document.getElementById('quiz-form').classList.add('hidden');
        document.getElementById('results').classList.remove('hidden');
        const score = calculateQuizScore();
        const resultsMessage = score >= 8 ? 
            'You got ' + score + '/10. Thank you for your attempt, you will receive your certificate shortly.' :
            'Unfortunately, you’ve only achieved ' + score + '/10. Please review the educational materials and try again!!';
        document.getElementById('results-message').innerText = resultsMessage;
    }

    function calculateQuizScore() {
        const correctAnswers = {
            q1: 'c',
            q2: 'b',
            q3: 'c',
            q4: 'a',
            q5: 'b',
            q6: 'b',
            q7: 'b',
            q8: 'a',
            q9: 'b',
            q10: 'b'
        };
        let score = 0;
        for (const [question, answer] of Object.entries(correctAnswers)) {
            const selectedAnswer = document.querySelector(`input[name="${question}"]:checked`);
            if (selectedAnswer && selectedAnswer.value === answer) {
                score++;
            }
        }
        return score;
    }

    function submitData() {
        const userData = {
            fullName: document.getElementById('full-name').value,
            email: document.getElementById('email').value,
            role: document.getElementById('role').value,
            state: document.getElementById('state').value,
            facilityName: document.getElementById('facility-name').value,
            score: calculateQuizScore().toString()
        };

        // Send data to Power Automate
        fetch('YOUR_POWER_AUTOMATE_URL', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(userData)
        }).then(response => response.json()).then(data => {
            console.log('Success:', data);
        }).catch((error) => {
            console.error('Error:', error);
        });
    }
</script>

</body>
</html>
